<template>
  <div
    :class="props.facility == 'mobile' ? 'anchorForMobil' : 'anchorForComputer'"
  >
    <el-anchor
      :offset="0"
      :bound="0"
      type="underline"
      target="#editContainer"
      @change="handelChange"
      :class="props.facility == 'mobile' ? 'anchorForMobil-background' : ''"
    >
      <el-anchor-link
        v-for="(anchor, index) in props.anchors"
        class="ml-2"
        :key="index"
        :href="`${anchor.href}`"
        style="padding: 0px !important"
      >
        <span
          class="anchor-font"
          :style="{ marginLeft: `${(anchor.level - 1) * anchorLeftMargin}px` }"
        >
          {{ anchor.title.split("🔗")[1] }}
        </span>
      </el-anchor-link>
    </el-anchor>
  </div>
</template>

<script setup>
import { computed } from "vue";
import { diffrentFacilifyMap } from "~/composables/util";

const props = defineProps({
  anchors: {
    type: Array,
    required: true,
  },
  facility: {
    required: true,
  },
});

const handelChange = (anchorValue) => {
  // 获取当前的状态
  let currentState = history.state;

  // 更新状态并替换当前的历史记录条目
  history.replaceState(currentState, null, anchorValue);
};

const anchorLeftMargin = computed(() => {
  return diffrentFacilifyMap(props.facility, {
    computer: 10,
    ipad: 8,
    mobile: 5,
  });
});
</script>

<style scoped>
.anchorForComputer {
  @apply fixed overflow-x-visible overflow-y-scroll mt-5 mr-2 min-w-[200px];
  width: auto;
  height: 90vh;
  overflow-y: scroll;
}

.anchorForMobil {
  @apply fixed overflow-x-visible overflow-y-scroll mt-5 rounded min-w-[200px];
  width: auto;
  max-height: 50vh;
  top: 40px;
  right: 0;
  z-index: 2;
  padding: 3px;
}
.anchorForMobil-background {
  background: linear-gradient(
    to left bottom,
    rgba(8, 219, 242, 0.386),
    rgba(54, 186, 186, 0.189)
  );
}

.anchor-font {
  color: #288ddb;
  font-weight: 600;
}

@media (min-width: 1200px) {
  .anchor-font {
    @apply text-sm;
  }
}

@media (max-width: 1200px) {
  .anchor-font {
    @apply text-sm;
  }
}

@media (max-width: 992px) {
  .anchor-font {
    @apply text-sm;
  }
}

@media (max-width: 768px) {
  .anchor-font {
    color: rgb(21, 216, 102);
    @apply text-sm;
    font-weight: 500;
  }
}
</style>
